@page "/"
@using BeerProduction.Services
@using Microsoft.AspNetCore.Components.Authorization
@inject AuthenticationStateService AuthenticationStateService
@inject NavigationManager NavigationManager

<PageTitle>Home</PageTitle>

<AuthorizeView>
    <Authorized>
        <div class="home-container">
            <h2>Welcome, @_username (@_role)</h2>
            <div>
                <p>
                    This system allows you to monitor and manage the beer production process efficiently.
                </p>
            </div>
        </div>
    </Authorized>
    <NotAuthorized>
        @{
            NavigationManager.NavigateTo("/login");
        }
    </NotAuthorized>
</AuthorizeView>

@code {

    private string? _username;
    private string? _role;

    protected override async Task OnInitializedAsync()
    {
        await Task.Delay(50);
        
        _username = AuthenticationStateService.GetUsername();
        _role = AuthenticationStateService.GetRole();
    }
}