<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Employee</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/manageStyle.css">
    <link rel="stylesheet" href="/css/headerStyle.css">
    <link rel="stylesheet" href="/css/bodyStyle.css">
</head>
<body class="Layout">
<header class="header-bar">
    <a href="/html/manager.html" aria-label="Back to Manager">
        <img class="logo" src="/assets/logo.png" alt="BeerProduction logo">
    </a>
    <div class="header-menu-bar"> <!-- Encapsulates all menu items -->
        <ul>
            <li class="dropdown"><a href="#">Workers</a>
                <div class="dropdown-menu" role="menu">
                    <ul>
                        <li><a class="menuitem" href="/html/workers.html">Employees</a></li>
                        <li><a class="menuitem" href="#">Operator</a></li>
                        <li><a class="menuitem" href="#">Analyzer</a></li>
                    </ul>
                </div>
            </li>
            <li><a href="#">Logout</a></li>
        </ul>
    </div>
</header>

<main class="body-content">
    <h2>Employees</h2>

    <div id="error" style="color:red;margin:.5rem 0;"></div>

    <table class="table" id="emp-table" style="width:100%;border-collapse:collapse;">
        <thead>
        <tr>
            <th style="text-align:left;border-bottom:1px solid #ccc;">ID</th>
            <th style="text-align:left;border-bottom:1px solid #ccc;">Name</th>
            <th style="text-align:left;border-bottom:1px solid #ccc;">Role</th>
            <th style="text-align:left;border-bottom:1px solid #ccc;">Hired</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</main>

<script>
    async function loadEmployees() {
        const err = document.getElementById('error');
        err.textContent = '';
        try {
            const res = await fetch('/api/employee');
            if (!res.ok) throw new Error('HTTP ' + res.status);
            const data = await res.json();

            const tbody = document.querySelector('#emp-table tbody');
            tbody.innerHTML = '';
            for (const e of data) {
                const tr = document.createElement('tr');
                tr.innerHTML =
                    `<td>${e.id}</td><td>${e.name}</td><td>${e.role}</td><td>${e.hiredOn ?? ''}</td>`;
                tbody.appendChild(tr);
            }
        } catch (ex) {
            console.error(ex);
            err.textContent = 'Failed to load employees: ' + ex.message;
        }
    }
    document.addEventListener('DOMContentLoaded', loadEmployees);
</script>
</body>
</html>
